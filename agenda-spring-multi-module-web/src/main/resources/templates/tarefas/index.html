<!DOCTYPE html>
<html th:replace="~{base::layout(~{::title}, ~{::section})}" xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Lista de tarefas</title>
	
	<th:block th:replace="~{fragmentos/arquivosDatatables :: cabecalho}" />
</head>
<body>
<section>
	<div class="card">
		<div class="card-header">
			<div class="row">
                <div class="col col-xs-6">
                    <h3 class="card-title">Tarefas cadastradas</h3>
                </div>
				<div class="col col-xs-6 text-end">
                    <a class="btn btn-success" th:href="@{tarefas/nova}">Nova</a>
                </div>
            </div>
	  	</div>
		<div class="card-body">
			<div class="alert alert-info" role="alert">
            	A lista está ordenada pela data do prazo 
            </div>
            <div class="table-responsive p-3">
                <table class="table table-striped table-hover align-middle" id="tableTarefas">
                </table>
            </div>
		</div>
	</div>

	<th:block th:replace="~{fragmentos/arquivosDatatables :: rodape}" />
	
	<script>
		$(document).ready(() => {
			new DataTable('#tableTarefas', {
				serverSide: true,
                processing: true,
                searchDelay: 500,
				pagingType: 'full_numbers',
				searching: false,
				ordering: false,
				language: {
			        url: '//cdn.datatables.net/plug-ins/1.13.7/i18n/pt-BR.json',
			    },
				ajax: {
					url: '/tarefas',
					type: 'GET',
					contentType: 'application/json' 
				},
				columns: [
					{title: '#', data: 'id'},
                    {title: 'Título', data: 'titulo', width: '35%'},
                    {title: 'Situação', data: 'situacao'},
                    {title: 'Prazo', data: 'prazo',
                    	render: (data) => {
                    		return new Date(data).toLocaleString();
                    	}
                   	},
                    {title: 'Visualizada', data: 'visualizada',
                    	render: (data) => {
                    		return (data) ? 'Sim' : 'Não';
                   		}
                    }
				]
			});
		});
	</script>
</section>
</body>
</html>